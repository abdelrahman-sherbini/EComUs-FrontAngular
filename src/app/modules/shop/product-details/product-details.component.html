<div class="product-details-page py-5" *ngIf="!loading && product; else loadingOrError">
  <div class="container">
    <div class="row">
      <!-- Product Images -->
      <div class="col-lg-5 col-md-6 text-center">
        <img
          [src]="mainImage"
          class="main-img img-fluid rounded shadow mb-3"
          [alt]="product.productName"
        />
        <div class="thumbnails-row d-flex justify-content-center gap-2 mt-3" *ngIf="(product.images ?? []).length > 1">
          <img
            *ngFor="let img of product.images"
            [src]="img"
            class="img-thumbnail thumb"
            [class.selected]="img === mainImage"
            (click)="setMainImage(img)"
            [alt]="product.productName"
          />
        </div>
      </div>
      <!-- Product Info -->
      <div class="col-lg-7 col-md-6">
        <h1 class="product-title">{{ product.productName }}</h1>
        <p class="product-desc">{{ product.description }}</p>
        <div class="mb-3 d-flex align-items-center gap-3 flex-wrap">
          <span class="product-price">${{ product.price }}</span>
          <span
            class="badge"
            [ngClass]="{
              'bg-success': product.quantity && product.quantity > 0,
              'bg-danger': !product.quantity || product.quantity < 1
            }"
          >
            {{ product.quantity && product.quantity > 0 ? 'In Stock' : 'Out of Stock' }}
          </span>
        </div>
        <!-- Quantity and Add to Cart -->
        <div class="add-to-cart-group d-flex align-items-center gap-3 mb-4">
          <label class="fw-semibold me-2" for="qtyInput">Quantity:</label>
          <input
            id="qtyInput"
            type="number"
            class="form-control"
            style="width: 80px;"
            min="1"
            [max]="product.quantity || 1"
            [(ngModel)]="selectedQty"
            [disabled]="!product.quantity || product.quantity < 1"
          />
          <button
            class="btn btn-primary"
            [disabled]="!product.quantity || selectedQty < 1 || selectedQty > (product.quantity || 1)"
            (click)="addToCart()"
          >
            <i class="bi bi-cart-plus"></i>
            Add to Cart
          </button>
        </div>
        <!-- Optionally show more product details, categories, etc. -->
      </div>
    </div>
  </div>
</div>

<ng-template #loadingOrError>
  <div class="container py-5 text-center">
    <div *ngIf="loading" class="spinner-border text-primary mb-2" style="width: 3rem; height: 3rem;" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <div *ngIf="error" class="alert alert-danger mt-3">
      {{ error }}
    </div>
  </div>
</ng-template>
